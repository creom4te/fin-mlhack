<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Calibracion de Modelos de Inteligencia Artificial. - Cronicas de Creo</title><meta name="description" content="Debería ser considerado por todo desarrollador como un paso fundamental en el proceso de aprendizaje automático. La finalidad de la&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://creom4te.com/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://creom4te.com/calibracion-de-modelos-de-inteligencia-artificial/"><link rel="alternate" type="application/atom+xml" href="https://creom4te.com/feed.xml"><link rel="alternate" type="application/json" href="https://creom4te.com/feed.json"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@creom4te"><meta name="twitter:title" content="Calibracion de Modelos de Inteligencia Artificial."><meta name="twitter:description" content="Debería ser considerado por todo desarrollador como un paso fundamental en el proceso de aprendizaje automático. La finalidad de la&hellip;"><meta name="twitter:image" content="https://creom4te.com/media/posts/17/calibre.jpg"><link rel="preload" href="https://creom4te.com/assets/dynamic/fonts/figtree/figtree.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://creom4te.com/assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="https://creom4te.com/assets/css/style.css?v=d5059748d5e5161c4db30cc121457fd6"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://creom4te.com/calibracion-de-modelos-de-inteligencia-artificial/"},"headline":"Calibracion de Modelos de Inteligencia Artificial.","datePublished":"2024-09-25T08:21","dateModified":"2024-09-25T17:43","image":{"@type":"ImageObject","url":"https://creom4te.com/media/posts/17/calibre.jpg","height":400,"width":800},"description":"Debería ser considerado por todo desarrollador como un paso fundamental en el proceso de aprendizaje automático. La finalidad de la&hellip;","author":{"@type":"Person","name":"Creom4te","url":"https://creom4te.com/authors/creom4te/"},"publisher":{"@type":"Organization","name":"Creom4te","logo":{"@type":"ImageObject","url":"https://creom4te.com/media/website/icono-creom4te-sinFondo-2.png","height":370,"width":391}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.fi{fill:none;stroke-linecap:round;stroke-linejoin:round;vertical-align:middle}</style></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo logo-image" href="https://creom4te.com/"><img src="https://creom4te.com/media/website/icono-creom4te-sinFondo-2.png" alt="Cronicas de Creo " width="391" height="370"></a></header><article class="post"><header class="main post__header"><time datetime="2024-09-25T08:21" class="post__date">septiembre 25, 2024</time><h1>Calibracion de Modelos de Inteligencia Artificial.</h1></header><figure class="image main normal"><img src="https://creom4te.com/media/posts/17/calibre.jpg" srcset="https://creom4te.com/media/posts/17/responsive/calibre-xs.jpg 300w, https://creom4te.com/media/posts/17/responsive/calibre-sm.jpg 480w, https://creom4te.com/media/posts/17/responsive/calibre-md.jpg 768w, https://creom4te.com/media/posts/17/responsive/calibre-lg.jpg 1024w, https://creom4te.com/media/posts/17/responsive/calibre-xl.jpg 1360w, https://creom4te.com/media/posts/17/responsive/calibre-xxl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="lazy" height="400" width="800" alt=""></figure><div class="post__inner post__entry"><p style="color: #000000; font-size: 20px;">Debería ser considerado por todo desarrollador como un paso fundamental en el proceso de aprendizaje automático. La finalidad de la calibración es "ajustar" las probabilidades que el modelo predice para que la realidad sea mejor reflejada por el modelo.</p><p><span style="color: #000000; font-size: 20px;">Las CNNs o Convolutional Neural Networks, en general tiene salidas que no estan bien calibradas, por lo que los valores de probabilidad que arrojan no se alinean con la verdadera realidad.</span></p><p><span style="color: #000000; font-size: 20px;">Por ejemplo una red le da el 90% de probabilidades a una clase de ser el resultado de la prediccion. Sin la calibracion, corremos el riesgo de que la realidad sobre la tasa de exito sobre esa clase es menor o mucho menor.</span></p><h4><span style="color: #000000; font-size: 20px;">Que importancia tiene?</span></h4><p><span style="color: #000000; font-size: 20px;">Obtener la clase mas probable de una prediccion NO es suficiente, ademas necesitamos <span style="text-decoration: underline;">entender</span> que tan seguro esta el modelo sobre esa prediccion. Si el modelo no esta bien calibrado seguro va a sobreestimar la confianza en las predicciones incorrectas.</span></p><p><span style="color: #000000; font-size: 20px;">Ademas un modelo que esta bien calibrado va a proporcionarnos mucho mejores probabilidades. Las cuales pueden ser aprovechadas mejor a la hora de tomar decisiones, evitando falsas alarmas.</span></p><p><span style="color: #000000; font-size: 20px;">Finalmente si el modelo se utiliza en un area donde la toma de decisiones debe ser totalmente transparente, calibrar nos ayuda a entender que las predicciones son justas y justificadas.</span></p><h4><span style="color: #000000; font-size: 20px;">Que metodos existen para calibrar?</span></h4><p><span style="color: #000000; font-size: 20px;">Dentro de los mas desarrollados tenemos a <strong>Platt Scaling, Isotonic Regression y Temperature Scaling</strong>.</span></p><p><span style="color: #000000; font-size: 20px;"><strong>Platt Scaling</strong>, es una tecnica muy utilizada, que toma como base una regresion logistica a la salida de un modelo, es decir en el vector de salida de la capa totalmente conectada. Esta capa ofrece valores de evidencia o logits, que el modelo acumulo para cada clase. Estos valores todavia NO son probabilidades y no estan en el rango de 0 a 1. Para eso, habria que pasarlos por una funcion de activacion como la funcion sigmoide si la salida es binaria o la funcion softmax si la salida es multiple.</span></p><p><span style="color: #000000; font-size: 20px;"><strong>Porque se usan los logits?</strong> Basicamente porque son los valores sin "normalizar" y permiten que el modelo trabaje sin restricciones, es decir los valores no estan acotados entre 0 y 1. Facilitando que la red pueda aprender sin las limitaciones de las probabilidades. De esta forma ajusta las predicciones a probabilidades mejor calibradas.</span></p><p><span style="color: #000000; font-size: 20px;"><strong>Isotonic Regression</strong>, es una tecnica que ajusta las probabilidades, mientras mantiene el orden de las predicciones en otras palabras, si una clase tiene mayor probabilidad antes de la calibracion, seguira siendo mayor despues de la calibracion.</span></p><p><span style="color: #000000; font-size: 20px;"><strong>Temperature Scaling</strong>, es la version simplificada de Platt Scaling y lo que hace es ajustar las salidas del modelo, mientras las divide por una constante llamada <strong>temperatura</strong>. Esta constante se ajusta con el fin de darle una mejor distribucion de probabilidad.</span></p><h4><span style="color: #000000; font-size: 20px;">Veamos algunos ejemplos.</span></h4><p><span style="color: #000000; font-size: 20px;">En el caso de que deseemos utilizar Platt Scaling, tenemos que tener en cuenta que es mas eficiente para salidas binarias es decir cuando solo tenemos 2 posibilidades para clasificar. Sin embargo puede ser utilizado en multiples clases sin problema.</span></p><p><span style="color: #000000; font-size: 20px;">Imaginemos que obtuvimos todas las predicciones sin calibrar de una red CNN, sobre un conjunto de datos para la calibracion. Intentemos poner esto en codigo python y entrenar un modelo en Platt Scaling:</span></p><pre class="language-python line-numbers"><code>from sklearn.linear_model import LogisticRegression

# Asi logramos las probabilidades sin calibrar del modelo
prob_no_calibradas = model.predict_proba(X_calibration)

# Ajustemos la regresion logistica
platt_model = LogisticRegression(), platt_model.fit(prob_no_calibradas, y_calibration)</code></pre><p><span style="color: #000000; font-size: 20px;">Ahora con el modelo ya entrenado, vamos a calibrar las nuevas predicciones.</span></p><pre class="language-python line-numbers"><code># Generemos nuevas predicciones del modelo
prob_no_calibradas_nuevas = model.predict_proba(X_new)

# Apliquemos la calibracion de Platt Scaling
prob_calibradas = platt_model.predict_proba(prob_no_calibradas_nuevas)
print(f"Estas son las Probabilidades calibradas: {prob.calibradas}")</code></pre><p><span style="color: #000000; font-size: 20px;">Ahora y para finalizar evaluemos la calibracion, mediante la expectativa de error en la calibracion.</span></p><p><span style="color: #000000; font-size: 20px;">Para esto usamos el Error de Calibracion Esperado (ECE), este error es una metrica que mide la diferencia entre la probabilidad predicha y la frecuencia real de ocurrencia de la clase predicha.</span></p><pre class="language-python line-numbers"><code>import numpy as np
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.calibration import calibration_curve

# Función que calcula el error de calibración esperado (ECE)
def expected_calibration_error(probabilities, true_labels, n_bins=10):
    """
    Calcula el error de calibración esperado (ECE).
    probabilities: Probabilidades predichas por el modelo.
    true_labels: Etiquetas verdaderas (0 o 1).
    n_bins: Número de intervalos (bins) para agrupar las probabilidades.
    """
    bin_boundaries = np.linspace(0, 1, n_bins + 1)
    bin_indices = np.digitize(probabilities, bin_boundaries, right=True) - 1
    ece = 0.0

    for i in range(n_bins):
        # Selecciona los índices correspondientes al bin actual
        in_bin = (bin_indices == i)
        prop_in_bin = np.mean(in_bin)
        
        if prop_in_bin &gt; 0:
            avg_confidence = np.mean(probabilities[in_bin])
            avg_accuracy = np.mean(true_labels[in_bin])
            ece += np.abs(avg_confidence - avg_accuracy) * prop_in_bin

    return ece

# Creando un conjunto de datos de clasificación binaria simple
X, y = make_classification(n_samples=1000, n_features=10, n_classes=2, random_state=42)

# Dividiendo el conjunto en datos de entrenamiento y prueba
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# Entrenando el modelo de regresión logística
model = LogisticRegression()
model.fit(X_train, y_train)

# Prediciendo las probabilidades del conjunto de prueba
probabilities = model.predict_proba(X_test)[:, 1]

# Calculando el ECE
ece = expected_calibration_error(probabilities, y_test, n_bins=10)
print(f'Error de Calibración Esperado (ECE): {ece:.4f}')
</code></pre><p><span style="color: #000000; font-size: 20px;">Con el codigo de arriba logramos determinar que el error ECE es de:</span></p><figure><figure class="post__image post__image--center"><img loading="lazy" src="https://creom4te.com/media/posts/17/Captura-de-pantalla-2024-09-25-161431.png" alt="" width="488" height="30" sizes="(max-width: 48em) 100vw, 768px" srcset="https://creom4te.com/media/posts/17/responsive/Captura-de-pantalla-2024-09-25-161431-xs.png 300w, https://creom4te.com/media/posts/17/responsive/Captura-de-pantalla-2024-09-25-161431-sm.png 480w, https://creom4te.com/media/posts/17/responsive/Captura-de-pantalla-2024-09-25-161431-md.png 768w"></figure><figcaption>El error es bajo pero esta presente.<br><br></figcaption></figure><p><span style="color: #000000; font-size: 20px;">Con todo lo hasta aca visto debe quedarnos mas claro porque la calibracion es crucial para mejorar la confianza en las predicciones de los modelos de clasificacion. Y por cierto, tanto Platt Scaling y Temperature Scaling se pueden aplicar de forma directa despues de entrenar la red.</span></p><p><span style="color: #000000; font-size: 20px;">Bueno es hora de que pongas en practica este nuevo conocimiento.</span></p><p><span style="color: #000000; font-size: 20px;">Y como te digo siempre, no dudes en mandarme un mail si necesitas ayuda.</span></p></div><footer class="post__inner post__footer"><div class="post__tag"><ul><li><strong>Tagged in:</strong></li><li><a href="https://creom4te.com/tags/cnn/">CNN</a></li><li><a href="https://creom4te.com/tags/deeplearning/">DeepLearning</a></li><li><a href="https://creom4te.com/tags/ia/">IA</a></li><li><a href="https://creom4te.com/tags/inteligencia-artificial/">Inteligencia Artificial</a></li></ul></div></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Ambito Forense</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/cookies-en-detalle/" target="_self">Cookies en DETALLE.</a></li></ul></li><li class="has-submenu"><a href="https://creom4te.com/enfoque-causal-o-estadistico/" title="Causalidad" target="_self" aria-haspopup="true" class="opener">Area de Finanzas</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/coin-coinbase/" target="_self">$COIN - CoinBase</a></li><li><a href="https://creom4te.com/dividendos-cedears/" target="_self">DIVIDENDOS -Cedears</a></li><li><a href="https://creom4te.com/googl-y-como-afecta-el-sesgo-de-gemini/" target="_self">$GOOGL y como afecta el “sesgo” de Gemini?</a></li><li><a href="https://creom4te.com/enfoque-causal-o-estadistico/" target="_self">Enfoque Causal o Estadistico.</a></li><li><a href="https://creom4te.com/caidas-del-sandp500-historicas/" target="_self">Caidas Historicas S&amp;P500</a></li></ul></li><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Espacio de Hacking</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/que-problema-me-dan-las-cookies/" target="_self">Que problema me dan las Cookies?</a></li><li><a href="https://creom4te.com/y-si-tu-pc-esta-infectada/" target="_self">Y si tu PC esta infectada?</a></li></ul></li><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Recomendaciones</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/ms-dos/" target="_self">MS-DOS Liberado por Microsoft!</a></li></ul></li><li><a href="https://creom4te.com/" title="Noticias" target="_self">Noticias Relevantes</a></li><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Inteligencia Artificial</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/salida-reludotentradawb/" target="_self">MNIST</a></li><li><a href="https://creom4te.com/etiquetar-el-eslabon-mas-debil/" target="_self">Etiquetar. El eslabon mas debil</a></li><li><a href="https://creom4te.com/etiquetando/" target="_self">Etiquetando</a></li></ul></li></ul></nav><section><header class="major"><h2>Mantene Contacto</h2></header><p>Esto representa conocimiento y experiencia. Voy a poner a disposicion mucho de lo que se sin condiciones. Puedo ayudarte si lo necesitas.<br><br>El conocimiento es dinamico. :)</p><ul class="contact"><li class="icon solid fa-envelope"><a href="#">creom4te@gmail.com</a></li><li class="icon solid fa-home">Argentina - Mundo.</li></ul></section><footer id="footer"><p class="copyright">2024 - © creom4te - todos los derechos reservados</p></footer></div></div></div><script src="https://creom4te.com/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://creom4te.com/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://creom4te.com/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://creom4te.com/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://creom4te.com/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script><script defer="defer" src="https://creom4te.com/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://creom4te.com/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://creom4te.com/media/plugins/syntaxHighlighter/prism-autolinker.min.js"></script></body></html>