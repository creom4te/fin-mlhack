<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>MNIST - Cronicas de Creo</title><meta name="description" content="salida = relu(dot(entrada.W)+b) 'En algun lugar lei que la mejor manera de aprender matematica en programacion es usando las operaciones&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://creom4te.com/salida-reludotentradawb/"><link rel="alternate" type="application/atom+xml" href="https://creom4te.com/feed.xml"><link rel="alternate" type="application/json" href="https://creom4te.com/feed.json"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@creom4te"><meta name="twitter:title" content="MNIST"><meta name="twitter:description" content="salida = relu(dot(entrada.W)+b) 'En algun lugar lei que la mejor manera de aprender matematica en programacion es usando las operaciones&hellip;"><meta name="twitter:image" content="https://creom4te.com/media/posts/14/MNIST-.webp"><link rel="preload" href="https://creom4te.com/assets/dynamic/fonts/figtree/figtree.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://creom4te.com/assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="https://creom4te.com/assets/css/style.css?v=171598e68d5286fb4325cd7485ccc134"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://creom4te.com/salida-reludotentradawb/"},"headline":"MNIST","datePublished":"2024-09-06T08:47","dateModified":"2024-09-06T20:40","image":{"@type":"ImageObject","url":"https://creom4te.com/media/posts/14/MNIST-.webp","height":521,"width":1100},"description":"salida = relu(dot(entrada.W)+b) 'En algun lugar lei que la mejor manera de aprender matematica en programacion es usando las operaciones&hellip;","author":{"@type":"Person","name":"Creom4te","url":"https://creom4te.com/authors/creom4te/"},"publisher":{"@type":"Organization","name":"Creom4te","logo":{"@type":"ImageObject","url":"https://creom4te.com/media/website/icono-creom4te-sinFondo-2.png","height":370,"width":391}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.fi{fill:none;stroke-linecap:round;stroke-linejoin:round;vertical-align:middle}</style></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo logo-image" href="https://creom4te.com/"><img src="https://creom4te.com/media/website/icono-creom4te-sinFondo-2.png" alt="Cronicas de Creo " width="391" height="370"></a></header><article class="post"><header class="main post__header"><time datetime="2024-09-06T08:47" class="post__date">septiembre 6, 2024</time><h1>MNIST</h1></header><figure class="image main normal"><img src="https://creom4te.com/media/posts/14/MNIST-.webp" srcset="https://creom4te.com/media/posts/14/responsive/MNIST--xs.webp 300w, https://creom4te.com/media/posts/14/responsive/MNIST--sm.webp 480w, https://creom4te.com/media/posts/14/responsive/MNIST--md.webp 768w, https://creom4te.com/media/posts/14/responsive/MNIST--lg.webp 1024w, https://creom4te.com/media/posts/14/responsive/MNIST--xl.webp 1360w, https://creom4te.com/media/posts/14/responsive/MNIST--xxl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="lazy" height="521" width="1100" alt="Obtenido de Koushik"><figcaption>Koushik</figcaption></figure><div class="post__inner post__entry"><h1>salida = relu(dot(entrada.W)+b)</h1><p><span style="color: #169179;"><em>"En algun lugar lei que la mejor manera de aprender matematica en programacion es usando las operaciones en lineas de codigo"</em></span></p><p><span style="color: #000000;">Hoy quiero contarles acerca de las Redes Neuronales Artificiales. Pero en especial del Deep Learning.</span></p><p><span style="color: #000000;">Para comenzar dejenme explicarles el titulo. Es simplemente una operacion matematica escrita en una linea de codigo que dice algo asi: <em>la <strong>salida</strong> es igual al producto "punto" de un tensor de <strong>entrada</strong> con un tensor <strong>W</strong>. A la matriz resultante de esa operacion (si! es matriz... entonces es un tensor de 2 ejes) se le suma el vector <strong>b</strong> (como habras deducido si es vector es de 1 solo eje). A TODO ese resultado se le aplica la funcion de activacion "<strong>relu</strong>", que basicamente nos va a decir si se activa o no la neurona. </em></span></p><p><span style="color: #000000;">Nos vamos a enfocar entonces en el "<em>Hola Mundo</em>" de las redes. Y eso es el conjunto</span></p><p><span style="color: #000000;">de datos MNIST.</span></p><p><span style="color: #000000;">Basicamente este conjunto es un conjunto de 60000 imagenes de imagenes de numeros manuscritos en blanco y negro (escala de grises) de tamaño 28 de alto por 28 de ancho.</span></p><p><span style="color: #000000;">A me olvidaba tambien hay otro conjunto de 10000 imagenes iguales que sirven como conjunto de prueba o testeo.</span></p><p><span style="color: #000000;">Las imagenes como dije representan numeros manuscritos que van del 0 al 9 y la idea es que mediante el conjunto de entrenamiento (60000 imagenes y sus correspondientes etiquetas) se pueda entrenar un modelo que logre predecir para cualquier etiqueta el numero que le corresponderia.</span></p><p><span style="color: #000000;">Pero antes crear el modelo, tengo que darte algunos datos:</span></p><ul><li><span style="color: #000000;">las etiquetas son matrices al igual que las imagenes. Eso quiere decir que ambos tienen 2 ejes. </span></li><li><span style="color: #000000;">Las etiquetas estan en un tipo de dato <em>uint8 o unsigned 8-bit integer </em>traducido seria algo asi como numero entero sin signo de 8 bits y sirve para representar numeros que van de 0 a 255. Solo pueden ser positivos, 8 bits es 1 byte, cada bit puede ser 0 o 1 lo que deja representar 2^8 = 256 valores.</span></li></ul><blockquote><p><span style="color: #000000;">AHORA SI!</span></p></blockquote><p><span style="color: #000000;">ARQUITECTURA DE LA RED.</span></p><p><span style="color: #000000;">Primero nos copiamos los datos MNIST:</span></p><pre class="language-python"><code>from tensorflow.keras.datasets import mnist
from tensorflow import keras
from tensorflow.keras import layers

(train_images, train_labels), (test_images, test_labels) = mnist.load_data()</code></pre><hr><p><span style="color: #000000;">Despues tenemos que darle a los datos la forma que el modelo requiere. Y para eso vamos a pasar las matrices de las etiquetas de valores <em>uint8</em> a valores <em>float32, </em>basicamente porque nos permite tener un rango mas amplio y permiten representar fracciones para calculos de alta precision. Ademas los vamos a escalar para que solo puedan tomar valores entre 0 y 1.</span></p><pre class="language-apacheconf"><code>train_images = train_images.astype("float32") / 255
test_images = test_images.astype("float32") / 255
</code></pre><p><span style="color: #000000;">Continuamos con la creacion de la Red propiamente dicha es decir la conjuncion de capas que haran todo el trabajo duro con los datos que les ofrezcamos en este caso los datos del conjunto MNIST.</span></p><pre class="language-apacheconf"><code>modelo = keras.Sequential([
    layers.Flatten(input_shape=(28, 28)),  
    layers.Dense(256, activation="relu"),
    layers.Dense(10, activation="softmax")
])
</code></pre><blockquote><p><span style="color: #000000;">Creamos el Modelo (nuestra red) con Sequential le decimos como se van a estructurar las capas. Y dentro creamos 3 capas de las cuales la primera es de tipo flatten es decir que aplana a las imagenes de 28x28 a un vector de 784 pixeles. Esto es necesario porque las capas Densas es decir totalmente conectadas, esperan entradas de 1 sola dimension ademas, estas capas estan conectadas una de ellas con 256 vias y la otra con 10 vias. La primera se opera con una funcion relu y le segunda con una funcion softmax.</span></p></blockquote><p><span style="color: #000000;">La idea con la utilizacion de capas es obtener mejores representaciones de los datos para que el objetivo buscado se logre.</span></p><p><span style="color: #000000;">Tambien necesitamos para que esto funcione 3 cosas mas: Un OPTIMIZADOR, Una FUNCION DE PERDIDA y claro analizar las METRICAS.</span></p><pre class="language-python"><code>modelo.compile(optimizer="rmsprop",
               loss="sparse_categorical_crossentropy",
               metrics=["accuracy"])</code></pre><blockquote><p><span style="color: #000000;">Necesitamos compilar tanto el optimizador, la funcion de perdida como las metricas.</span></p></blockquote><p><span style="color: #000000;">Con esto estariamos ya en condiciones de entrenar nuestro modelo. Y lo hacemos de la siguiente manera.</span></p><pre class="language-apacheconf"><code>modelo.fit(train_images, train_labels, epochs=8, batch_size=128,
           validation_data=(test_images, test_labels))</code></pre><p><span style="color: #000000;">El resultado de entrenar el modelo nos ofrecera informacion sobre el progreso de entrenamiento. El valor de perdida (loss) que para cada epoca nos dira cuan bien o mal el modelo esta ajustando sus predicciones a las etiquetas verdaderas. Por otro lado la precision (acurracy) es decir la cantidad de predicciones correctas que el modelo hace.</span></p><p><span style="color: #000000;">Y finalmente la perdida del conjunto de validacion para cada epoca y la precision del modelo para cada epoca del conjunto de validacion.</span></p><p><span style="color: #000000;">Abajo te mostramos un ejemplo del resultado de entrenar el modelo:</span></p><figure class="post__image"><img loading="lazy" src="https://creom4te.com/media/posts/14//Captura-de-pantalla-2024-09-06-082156.png" alt="" width="1301" height="268" sizes="(max-width: 48em) 100vw, 768px" srcset="https://creom4te.com/media/posts/14//responsive/Captura-de-pantalla-2024-09-06-082156-xs.png 300w, https://creom4te.com/media/posts/14//responsive/Captura-de-pantalla-2024-09-06-082156-sm.png 480w, https://creom4te.com/media/posts/14//responsive/Captura-de-pantalla-2024-09-06-082156-md.png 768w"></figure><p><span style="color: #000000;">Bueno hagamos algunos experimentos mas:</span></p><pre class="language-apacheconf"><code>modelo = load_model('mi_modelo.h5')
digitos_a_testear = test_images[99]
predicciones = modelo.predict(digitos_a_testear)</code></pre><p><span style="color: #000000;">Lo que estamos haciendo es probando que tal lo hace nuestro modelo entrenado "mi_modelo" con la imagen "99" del conjunto de imagenes de testeo.</span></p><figure class="post__image"><img loading="lazy" src="https://creom4te.com/media/posts/14/Captura-de-pantalla-2024-09-06-132015.png" alt="" width="682" height="98" sizes="(max-width: 48em) 100vw, 768px" srcset="https://creom4te.com/media/posts/14/responsive/Captura-de-pantalla-2024-09-06-132015-xs.png 300w, https://creom4te.com/media/posts/14/responsive/Captura-de-pantalla-2024-09-06-132015-sm.png 480w, https://creom4te.com/media/posts/14/responsive/Captura-de-pantalla-2024-09-06-132015-md.png 768w"></figure><p><span style="color: #000000;">El resultado son las probabilidades de que represente uno de los 9 digitos del conjunto y en este caso podemos ver que en la posicion 9 tenemos el 9.99% de probabilidades de que la imagen 99 sea un 9. Vamos a comprobarlo!</span></p><pre class="language-python"><code>import matplotlib.pyplot as plt

imagen_a_mostrar = test_images[99]
etiqueta = test_labels[99]

plt.imshow(imagen_a_mostrar, cmap='gray')
plt.title(f'Etiqueta: {etiqueta}')
plt.colorbar()
plt.show()</code></pre><p><span style="color: #000000;">Lo que nos da como resultado que la imagen 99 corresponde a:</span></p><figure class="post__image"><img loading="lazy" src="https://creom4te.com/media/posts/14/Captura-de-pantalla-2024-09-06-132955.png" alt="" width="617" height="534" sizes="(max-width: 48em) 100vw, 768px" srcset="https://creom4te.com/media/posts/14/responsive/Captura-de-pantalla-2024-09-06-132955-xs.png 300w, https://creom4te.com/media/posts/14/responsive/Captura-de-pantalla-2024-09-06-132955-sm.png 480w, https://creom4te.com/media/posts/14/responsive/Captura-de-pantalla-2024-09-06-132955-md.png 768w"></figure><p> </p><p> </p></div><footer class="post__inner post__footer"></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Ambito Forense</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/cookies-en-detalle/" target="_self">Cookies en DETALLE.</a></li></ul></li><li class="has-submenu"><a href="https://creom4te.com/enfoque-causal-o-estadistico/" title="Causalidad" target="_self" aria-haspopup="true" class="opener">Area de Finanzas</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/coin-coinbase/" target="_self">$COIN - CoinBase</a></li><li><a href="https://creom4te.com/dividendos-cedears/" target="_self">DIVIDENDOS -Cedears</a></li><li><a href="https://creom4te.com/googl-y-como-afecta-el-sesgo-de-gemini/" target="_self">$GOOGL y como afecta el “sesgo” de Gemini?</a></li><li><a href="https://creom4te.com/enfoque-causal-o-estadistico/" target="_self">Enfoque Causal o Estadistico.</a></li><li><a href="https://creom4te.com/caidas-del-sandp500-historicas/" target="_self">Caidas Historicas S&amp;P500</a></li></ul></li><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Espacio de Hacking</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/que-problema-me-dan-las-cookies/" target="_self">Que problema me dan las Cookies?</a></li><li><a href="https://creom4te.com/y-si-tu-pc-esta-infectada/" target="_self">Y si tu PC esta infectada?</a></li></ul></li><li class="has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Recomendaciones</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://creom4te.com/ms-dos/" target="_self">MS-DOS Liberado por Microsoft!</a></li></ul></li><li><a href="https://creom4te.com/" title="Noticias" target="_self">Noticias Relevantes</a></li><li class="active-parent has-submenu"><a href="https://creom4te.com/" target="_self" aria-haspopup="true" class="opener">Inteligencia Artificial</a><ul class="submenu level-2" aria-hidden="true"><li class="active"><a href="https://creom4te.com/salida-reludotentradawb/" target="_self">MNIST</a></li></ul></li></ul></nav><section><header class="major"><h2>Mantene Contacto</h2></header><p>Esto representa conocimiento y experiencia. Voy a poner a disposicion mucho de lo que se sin condiciones. Puedo ayudarte si lo necesitas.<br><br>El conocimiento es dinamico. :)</p><ul class="contact"><li class="icon solid fa-envelope"><a href="#">creom4te@gmail.com</a></li><li class="icon solid fa-home">Argentina - Mundo.</li></ul></section><footer id="footer"><p class="copyright">2024 - © creom4te - todos los derechos reservados</p></footer></div></div></div><script src="https://creom4te.com/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://creom4te.com/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://creom4te.com/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://creom4te.com/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://creom4te.com/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script></body></html>